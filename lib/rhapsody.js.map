{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/rhapsody.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","stringify","JSON","k","v","id","name","method","fname","old","arguments","apply","this","ACCESS_TOKEN_KEY","REFRESH_TOKEN_KEY","Member","obj","Rhapsody","init","options","api","consumerKey","version","catalog","player","that","$exist","document","getElementById","HTMLIFrameElement","win","$iframe","createElement","src","frameBorder","style","display","addEventListener","body","appendChild","host","endpoint","secure","join","headers","h","member","accessToken","dataType","get","path","cb","fetch","then","json","post","data","console","log","put","del","m","window","localStorage","refreshToken","frameReady","ready","auth","windows","play","previewer","pause","next","previous","queue","clearQueue","toggleShuffle","toggleRepeat","seek","setVolume","on","eventName","callback","p","type","paused","playing","authed","replace","c","currentTrack","args","contentWindow","postMessage","util","jsonClean","secondsToTime","isNaN","minutes","Math","floor","seconds","parse","prototype","creds","removeItem"],"mappings":"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","file":"rhapsody.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","//  Copyright (c) 2016 Rhapsody International\n//  Code released under the MIT license.\n//  See https://github.com/Rhapsody/rhapsody.js#the-mit-license-mit for more detail.\n//  The first thing you need to do, after including Rhapsody.js in your app (but before using it), is initialize the Rhapsody object with your application key.\n//\n//     Rhapsody.init({\n//       consumerKey: 'foo'\n//     });\n//\n\n(function () {\n\n\t'use strict';\n\n\tvar stringify = JSON.stringify;\n\tJSON.stringify = function (o) {\n\t\treturn stringify(o, function (k, v) {\n\t\t\tif (k === 'genre') {\n\t\t\t\treturn {\n\t\t\t\t\tid: v.id,\n\t\t\t\t\tname: v.name\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn v;\n\t\t});\n\t};\n\n\tvar method = function (o, fname, f) {\n\t\tvar old = o[fname];\n\t\to[fname] = function () {\n\t\t\tif (f.length === arguments.length) {\n\t\t\t\treturn f.apply(this, arguments); // o -> this\n\t\t\t}\n\t\t\telse if (typeof old === 'function') {\n\t\t\t\treturn old.apply(this, arguments);\n\t\t\t}\n\t\t};\n\t};\n\n\tvar ACCESS_TOKEN_KEY = 'rhapsody.member.accessToken',\n\t\tREFRESH_TOKEN_KEY = 'rhapsody.member.refreshToken';\n\n\tvar Member = function (obj) {\n\t\tfor (var k in obj) {\n\t\t\tthis[k] = obj[k];\n\t\t}\n\t};\n\n\tvar Library = function (member) {\n\t\tthis.member = member;\n\t};\n\n\tvar Rhapsody = {\n\n\t\t// ### Initialization Options\n\t\t// Set your developer key and application ID here.  You can also (optionally) specify which API and catalog versions you prefer.\n\t\t//\n\t\t//     Rhapsody.init({\n\t\t//       consumerKey: options.consumerKey,\n\t\t//       version: 'v1',\n\t\t//       catalog: 'EN'\n\t\t//     });\n\n\t\tinit: function (options) {\n\t\t\tthis.api.consumerKey = options.consumerKey;\n\t\t\tthis.api.version = options.version || this.api.version;\n\t\t\tthis.api.catalog = options.catalog || this.api.catalog;\n\n\t\t\tvar id = options.player || 'player-frame';\n\n\t\t\tif (id && typeof id === 'string') {\n\t\t\t\tvar that = this;\n\t\t\t\tconst $exist = document.getElementById(id);\n\n\t\t\t\tif (!$exist) {\n\t\t\t\t\tconst $iframe = document.createElement('iframe');\n\t\t\t\t\t$iframe.id = id;\n\t\t\t\t\t$iframe.name = id;\n\t\t\t\t\t$iframe.src = `http://api.rhapsody.com/v1.1/player/index.html?apikey=${options.consumerKey}`;\n\t\t\t\t\t$iframe.frameBorder = 'none';\n\t\t\t\t\t$iframe.style.display = 'none';\n\t\t\t\t\t$iframe.addEventListener('load', () => that.player.win = $iframe);\n\t\t\t\t\tdocument.body.appendChild($iframe);\n\t\t\t\t}\n\t\t\t\telse if ($exist instanceof HTMLIFrameElement) {\n\t\t\t\t\tthat.player.win = $exist;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthrow new Error('The element \"' + id + '\" is not an HTMLIFrameElement.')\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tapi: {\n\t\t\thost: 'api.rhapsody.com',\n\t\t\tcatalog: 'US',\n\t\t\tversion: 'v1',\n\t\t\tendpoint: function (secure) {\n\t\t\t\treturn (secure ? 'https://' : 'http://') + [this.host, this.version].join('/');\n\t\t\t},\n\t\t\theaders: function (secure) {\n\t\t\t\tvar h = {};\n\n\t\t\t\tif (secure && Rhapsody.member.accessToken) {\n\t\t\t\t\th['Authorization'] = 'Bearer ' + Rhapsody.member.accessToken;\n\t\t\t\t}\n\n\t\t\t\treturn h;\n\t\t\t},\n\t\t\tdataType: function () {\n\t\t\t\treturn 'json';\n\t\t\t},\n\n\t\t\tget: function (secure, path, cb) {\n\t\t\t\tfetch(`${this.endpoint(secure)}${path}?apikey=${this.consumerKey}`).then((r) => r.json()).then((r) => cb(r));\n\t\t\t},\n\n\t\t\tpost: function (secure, path, data, cb) {\n\t\t\t\tconsole.log('TODO POST');\n\t\t\t\t// if (!data) data = {};\n\n\t\t\t\t// $.ajax({\n\t\t\t\t// \ttype: data._method || 'POST',\n\t\t\t\t// \tdata: data,\n\t\t\t\t// \tdataType: this.dataType(),\n\t\t\t\t// \theaders: this.headers(secure),\n\t\t\t\t// \turl: this.endpoint(secure) + path + (secure ? '' : '?apikey=' + this.consumerKey),\n\t\t\t\t// \tsuccess: function (data, textStatus, jqXHR) {\n\t\t\t\t// \t\tcb(data);\n\t\t\t\t// \t},\n\t\t\t\t// \terror: function (jqXHR) {\n\t\t\t\t// \t\tcb({ status: jqXHR.status, error: jqXHR.statusText, response: jqXHR.responseJSON });\n\t\t\t\t// \t}\n\t\t\t\t// });\n\t\t\t},\n\n\t\t\tput: function (secure, path, data, cb) {\n\t\t\t\tconsole.log('TODO POST');\n\t\t\t\t// data._method = 'PUT';\n\t\t\t\t// this.post.call(this, secure, path, data, cb);\n\t\t\t},\n\n\t\t\tdel: function (secure, path, data, cb) {\n\t\t\t\tconsole.log('TODO DELETE');\n\t\t\t\t// data._method = 'DELETE';\n\t\t\t\t// this.post.call(this, secure, path, data, cb);\n\t\t\t}\n\t\t},\n\n\t\tmember: new function () {\n\t\t\tvar m = new Member({\n\t\t\t\taccessToken: window.localStorage[ACCESS_TOKEN_KEY],\n\t\t\t\trefreshToken: window.localStorage[REFRESH_TOKEN_KEY]\n\t\t\t});\n\n\t\t\treturn m;\n\t\t},\n\n\t\t// ### Playback\n\t\t// The Rhapsody object exposes a top-level ``player`` object that gives you just about everything you need to manage playback.\n\n\t\tplayer: {\n\t\t\tframeReady: false,\n\t\t\tready: false,\n\n\t\t\tauth: function () {\n\t\t\t\tif (Rhapsody.api.consumerKey && Rhapsody.member.accessToken) {\n\t\t\t\t\tRhapsody.windows(this.win).post('auth', { consumerKey: Rhapsody.api.consumerKey, accessToken: Rhapsody.member.accessToken });\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// #### Playing a Track\n\t\t\t// You can play a track ID or Track object.  (Track objects are detailed below.)\n\t\t\t//\n\t\t\t//     Rhapsody.player.play('Tra.5156528');\n\t\t\t//\n\t\t\t// or\n\t\t\t//\n\t\t\t//     Track.find('Tra.5156528', function(t) {\n\t\t\t//       Rhapsody.player.play(t);\n\t\t\t//     });\n\n\t\t\tplay: function (o) {\n\t\t\t\tRhapsody.previewer.pause();\n\t\t\t\tRhapsody.windows(this.win).post('play', o);\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t// #### Pausing\n\t\t\t//\n\t\t\t//     Rhapsody.player.pause();\n\n\t\t\tpause: function () {\n\t\t\t\tRhapsody.windows(this.win).post('pause');\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t// #### Skipping to the Next Track\n\t\t\t//\n\t\t\t//     Rhapsody.player.next();\n\n\t\t\tnext: function () {\n\t\t\t\tRhapsody.windows(this.win).post('playNext');\n\t\t\t},\n\n\t\t\t// #### Skipping to the Previous Track\n\t\t\t//\n\t\t\t//     Rhapsody.player.previous();\n\n\t\t\tprevious: function () {\n\t\t\t\tRhapsody.windows(this.win).post('playPrevious');\n\t\t\t},\n\n\t\t\t// #### Queueing a Track\n\t\t\t//\n\t\t\t//     Rhapsody.player.queue('Tra.5156528');\n\n\t\t\tqueue: function (o) {\n\t\t\t\tRhapsody.windows(this.win).post('queue', o);\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t// #### Clear the Queue\n\t\t\t//\n\t\t\t//     Rhapsody.player.clearQueue();\n\n\t\t\tclearQueue: function () {\n\t\t\t\tRhapsody.windows(this.win).post('clearQueue');\n\t\t\t},\n\n\t\t\t// #### Shuffle\n\t\t\t//\n\t\t\t//     Rhapsody.player.toggleShuffle();\n\t\t\t//\n\n\t\t\ttoggleShuffle: function () {\n\t\t\t\tRhapsody.windows(this.win).post('toggleShuffle');\n\t\t\t},\n\n\t\t\t// #### Repeat\n\t\t\t//\n\t\t\t//     Rhapsody.player.toggleRepeat();\n\n\t\t\ttoggleRepeat: function () {\n\t\t\t\tRhapsody.windows(this.win).post('toggleRepeat');\n\t\t\t},\n\n\t\t\t// #### Seek\n\t\t\t// For example, to seek to 0:10 in a given track:\n\t\t\t//\n\t\t\t//     Rhapsody.player.seek(10);\n\n\t\t\tseek: function (t) {\n\t\t\t\tRhapsody.windows(this.win).post('seek', t);\n\t\t\t},\n\n\t\t\t// #### Set volume\n\t\t\t// Volume should be in range [0,1]\n\t\t\t//\n\t\t\t//     Rhapsody.player.setVolume(0.8);\n\n\t\t\tsetVolume: function (n) {\n\t\t\t\tRhapsody.windows(this.win).post('setVolume', n);\n\t\t\t},\n\n\t\t\t// ### Playback Events\n\t\t\t// There are a number of interesting playback-related events you can listen for:\n\t\t\t//\n\t\t\t//   * playevent: Starts, pauses, completes, etc.\n\t\t\t//   * playtimer: Current time, total time, waveform data\n\t\t\t//   * error: Bad things\n\t\t\t//\n\t\t\t// Listening for player events is simple:\n\t\t\t//\n\t\t\t//     Rhapsody.player.on('playevent', function(e) {\n\t\t\t//       console.log(e.data);\n\t\t\t//     });\n\t\t\t//\n\t\t\t//     Rhapsody.player.on('playtimer', function(e) {\n\t\t\t//       console.log(e.data);\n\t\t\t//     });\n\t\t\t//\n\t\t\t//     Rhapsody.player.on('error', function(e) {\n\t\t\t//       console.log(e.data);\n\t\t\t//     });\n\n\t\t\ton: function (eventName, callback) {\n\t\t\t\tvar p = this;\n\n\t\t\t\twindow.addEventListener('message', function (m) {\n\n\t\t\t\t\tif (m.data.type === 'playerframeready') {\n\t\t\t\t\t\tp.frameReady = true;\n\t\t\t\t\t}\n\t\t\t\t\telse if (m.data.type === 'ready') {\n\t\t\t\t\t\tp.ready = true;\n\t\t\t\t\t}\n\t\t\t\t\telse if (m.data.type === 'playsessionexpired') {\n\t\t\t\t\t\tp.paused = false;\n\t\t\t\t\t\tp.playing = false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (p.frameReady && p.ready && !p.authed) {\n\t\t\t\t\t\tp.authed = true;\n\t\t\t\t\t\tp.auth();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (m.data.type === eventName) {\n\t\t\t\t\t\tif (m.data.data && m.data.data.id) {\n\t\t\t\t\t\t\tm.data.data.id = m.data.data.id.replace('tra', 'Tra');\n\n\t\t\t\t\t\t\tvar c = m.data.data.code,\n\t\t\t\t\t\t\t\tplaying = (c === 'PlayStarted' || (c !== 'PlayComplete' && c !== 'Paused' && c !== 'BufferEmpty' && c !== 'NetworkDropped' && c !== 'PlayInterrupted' && c !== 'IdleTimeout')),\n\t\t\t\t\t\t\t\tpaused = (c === 'Paused' || c === 'NetworkDropped' || c === 'PlayInterrupted' || c === 'IdleTimeout');\n\n\t\t\t\t\t\t\tp.playing = m.data.data.playing = playing;\n\t\t\t\t\t\t\tp.paused = m.data.data.paused = paused;\n\t\t\t\t\t\t\tp.currentTrack = (p.playing || p.paused) ? m.data.data.id : null;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcallback.call(this, m.data);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t},\n\t\tpreviewer: {\n\t\t\tplay: function () {\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tpause: function () {\n\t\t\t\treturn this;\n\t\t\t}\n\t\t},\n\t\twindows: function (win) {\n\t\t\treturn {\n\t\t\t\tpost: function (method, args) {\n\t\t\t\t\tif (!win) {\n\t\t\t\t\t\tthrow new Error('An iframe was not found at that reference.');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\twin.contentWindow.postMessage({ method: method, args: Rhapsody.util.jsonClean(args || {}) }, \"*\");\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\ton: function (eventName, callback) {\n\t\t\twindow.addEventListener(eventName, callback);\n\t\t},\n\t\tutil: {\n\t\t\tsecondsToTime: function (s) {\n\t\t\t\tif (!isNaN(s)) {\n\t\t\t\t\tvar minutes = Math.floor(s / 60);\n\t\t\t\t\tvar seconds = Math.floor(s) % 60;\n\t\t\t\t\treturn minutes + ':' + ((seconds < 10) ? '0' + seconds : seconds);\n\t\t\t\t}\n\t\t\t\treturn '0:00';\n\t\t\t},\n\t\t\tjsonClean: function (o) {\n\t\t\t\treturn JSON.parse(JSON.stringify(o, function (k, v) {\n\t\t\t\t\tif (k === 'genre') return { id: v.id, name: v.name };\n\t\t\t\t\treturn v;\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\t};\n\n\tmethod(Member.prototype, 'set', function (creds) {\n\t\tif (creds && creds.accessToken && creds.refreshToken) {\n\t\t\tthis.accessToken = window.localStorage[ACCESS_TOKEN_KEY] = creds.accessToken;\n\t\t\tthis.refreshToken = window.localStorage[REFRESH_TOKEN_KEY] = creds.refreshToken;\n\n\t\t\tRhapsody.player.auth();\n\t\t}\n\t});\n\n\tmethod(Member.prototype, 'unset', function () {\n\t\tthis.accessToken = this.refreshToken = null;\n\n\t\twindow.localStorage.removeItem(ACCESS_TOKEN_KEY);\n\t\twindow.localStorage.removeItem(REFRESH_TOKEN_KEY);\n\t});\n\n\tmethod(Member.prototype, 'load', function () {\n\t\tthis.accessToken = window.localStorage[ACCESS_TOKEN_KEY];\n\t\tthis.refreshToken = window.localStorage[REFRESH_TOKEN_KEY];\n\n\t\treturn this;\n\t});\n\n\tmethod(Member.prototype, 'signedIn', function () {\n\t\treturn (this.accessToken != null && this.refreshToken != null);\n\t});\n\n\t// Everyone listens to these events\n\tRhapsody.player\n\t\t.on('playevent', function (e) { })\n\t\t.on('playtimer', function (e) { });\n\n\twindow.Rhapsody = Rhapsody;\n\twindow.Member = Member;\n\n})();\n"]}