!function e(n,t,o){function r(a,s){if(!t[a]){if(!n[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var d=t[a]={exports:{}};n[a][0].call(d.exports,function(e){var t=n[a][1][e];return r(t?t:e)},d,d.exports,e,n,t,o)}return t[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(e,n,t){"use strict";!function(){var e=JSON.stringify;JSON.stringify=function(n){return e(n,function(e,n){return"genre"===e?{id:n.id,name:n.name}:n})};var n=function(e,n,t){var o=e[n];e[n]=function(){return t.length===arguments.length?t.apply(this,arguments):"function"==typeof o?o.apply(this,arguments):void 0}},t="rhapsody.member.accessToken",o="rhapsody.member.refreshToken",r=function(e){for(var n in e)this[n]=e[n]},i={init:function(e){this.api.consumerKey=e.consumerKey,this.api.version=e.version||this.api.version,this.api.catalog=e.catalog||this.api.catalog;var n=e.player||"player-frame";if(n&&"string"==typeof n){var t=this,o=document.getElementById(n);if(o){if(!(o instanceof HTMLIFrameElement))throw new Error('The element "'+n+'" is not an HTMLIFrameElement.');t.player.win=o}else!function(){var o=document.createElement("iframe");o.id=n,o.name=n,o.src="http://api.rhapsody.com/v1.1/player/index.html?apikey="+e.consumerKey,o.frameBorder="none",o.style.display="none",o.addEventListener("load",function(){return t.player.win=o}),document.body.appendChild(o)}()}},api:{host:"api.rhapsody.com",catalog:"US",version:"v1",endpoint:function(e){return(e?"https://":"http://")+[this.host,this.version].join("/")},headers:function(e){var n={};return e&&i.member.accessToken&&(n.Authorization="Bearer "+i.member.accessToken),n},dataType:function(){return"json"},get:function(e,n,t){fetch(""+this.endpoint(e)+n+"?apikey="+this.consumerKey).then(function(e){return e.json()}).then(function(e){return t(e)})},post:function(e,n,t,o){console.log("TODO POST")},put:function(e,n,t,o){console.log("TODO POST")},del:function(e,n,t,o){console.log("TODO DELETE")}},member:new function(){var e=new r({accessToken:window.localStorage[t],refreshToken:window.localStorage[o]});return e},player:{frameReady:!1,ready:!1,auth:function(){i.api.consumerKey&&i.member.accessToken&&i.windows(this.win).post("auth",{consumerKey:i.api.consumerKey,accessToken:i.member.accessToken})},play:function(e){return i.previewer.pause(),i.windows(this.win).post("play",e),this},pause:function(){return i.windows(this.win).post("pause"),this},next:function(){i.windows(this.win).post("playNext")},previous:function(){i.windows(this.win).post("playPrevious")},queue:function(e){return i.windows(this.win).post("queue",e),this},clearQueue:function(){i.windows(this.win).post("clearQueue")},toggleShuffle:function(){i.windows(this.win).post("toggleShuffle")},toggleRepeat:function(){i.windows(this.win).post("toggleRepeat")},seek:function(e){i.windows(this.win).post("seek",e)},setVolume:function(e){i.windows(this.win).post("setVolume",e)},on:function(e,n){var t=this;return window.addEventListener("message",function(o){if("playerframeready"===o.data.type?t.frameReady=!0:"ready"===o.data.type?t.ready=!0:"playsessionexpired"===o.data.type&&(t.paused=!1,t.playing=!1),t.frameReady&&t.ready&&!t.authed&&(t.authed=!0,t.auth()),o.data.type===e){if(o.data.data&&o.data.data.id){o.data.data.id=o.data.data.id.replace("tra","Tra");var r=o.data.data.code,i="PlayStarted"===r||"PlayComplete"!==r&&"Paused"!==r&&"BufferEmpty"!==r&&"NetworkDropped"!==r&&"PlayInterrupted"!==r&&"IdleTimeout"!==r,a="Paused"===r||"NetworkDropped"===r||"PlayInterrupted"===r||"IdleTimeout"===r;t.playing=o.data.data.playing=i,t.paused=o.data.data.paused=a,t.currentTrack=t.playing||t.paused?o.data.data.id:null}n.call(this,o.data)}}),this}},previewer:{play:function(){return this},pause:function(){return this}},windows:function(e){return{post:function(n,t){if(!e)throw new Error("An iframe was not found at that reference.");e.contentWindow.postMessage({method:n,args:i.util.jsonClean(t||{})},"*")}}},on:function(e,n){window.addEventListener(e,n)},util:{secondsToTime:function(e){if(!isNaN(e)){var n=Math.floor(e/60),t=Math.floor(e)%60;return n+":"+(t<10?"0"+t:t)}return"0:00"},jsonClean:function(e){return JSON.parse(JSON.stringify(e,function(e,n){return"genre"===e?{id:n.id,name:n.name}:n}))}}};n(r.prototype,"set",function(e){e&&e.accessToken&&e.refreshToken&&(this.accessToken=window.localStorage[t]=e.accessToken,this.refreshToken=window.localStorage[o]=e.refreshToken,i.player.auth())}),n(r.prototype,"unset",function(){this.accessToken=this.refreshToken=null,window.localStorage.removeItem(t),window.localStorage.removeItem(o)}),n(r.prototype,"load",function(){return this.accessToken=window.localStorage[t],this.refreshToken=window.localStorage[o],this}),n(r.prototype,"signedIn",function(){return null!=this.accessToken&&null!=this.refreshToken}),i.player.on("playevent",function(e){}).on("playtimer",function(e){}),window.Rhapsody=i,window.Member=r}()},{}]},{},[1]);
//# sourceMappingURL=rhapsody.js.map